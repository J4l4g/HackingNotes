#Escalada #AbusoServicios
###### Enumeración
Para ver los servicios que se ejecutan internamente cada X tiempo usaremos `systemctl list-timers`, y veremos los que estén activos.
También podemos usar herramientas como [[PSPY]], solo tenemos que mantenerlo un rato en ejecución para acabar encontrando el servicio en ejecución.
Desde las raíz podemos buscar también con `find / -name <nombre.service> 2>/dev/null` y nos mostrara la ruta y podemos ver en que consiste el servicio.

###### Explotación
Si el servicio vemos que hace update y tenemos escritura en `/etc/apt/apt.conf.d` podríamos incluir una nueva política para determinar que comandos se ejecuten antes de hacer el update;
antes del update (Pre Invoke) después del update (Post Invoke).
Dentro de la ruta creamos un fichero llamado por ejemplo `01privesc` dentro añadiremos el siguiente contenido.
```shell
APT::Update::Pre-Invoke{"chmod u+s /bin/bash"; };
```
En cuanto el servicio se vuelva a ejecutar se nos cambiara la bash y 