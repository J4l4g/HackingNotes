#Escalada #PythonLibraryHijacking
###### Definición
Se trata de secuestrar librerías de Python creando como usuario un archivo con el nombre de la librería que utiliza ese binario de Python.

###### Enumeración
Usaremos `sudo -l` [[00.- Sudoers]] y hemos visto un script que podíamos ejecutar.
Después debemos de ver que librerías usa el binario de Python pongamos un ejemplo:
	Usa la librería: testlibreria.
Con esta información nos bastaría para ir a la explotación.

###### Explotación
Una vez identificada la librería crearemos en nuestro directorio actual un archivo con el nombre de la librería y la extensión `.py` en este caso `testlibreria.py`, dentro de este binario importaremos la librería `os`
```python
import os

os.system("bash -p")
```

Ejecutaremos el script desde la ubicación donde tenemos `testlibreria.py` pero para ejecutar el script lo tenemos que hacer con el nombre del creador del script principal:
`sudo -u <user> python3 /directorio/testlibreria.py`, con esto obtendremos la sesión de root.